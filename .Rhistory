oneway<-function(x){
#fit
fit <- lm(formula, data)
#summary statistics
stats <- aggregate(formula, data,
function(x) c(n=length(x),
mean = mean(x),
sd = sd(x)))
# return results
result<- list(anova = fit, summary = stats)
class(result) <- "oneway"
return(result)
}
library(oneway)
?oneway
plot.oneway <- function(x,...){
if(!inherits(x, "oneway")){
stop("Must be class 'oneway")
}
boxplot(x$anova$terms, x$anova$model, ...)
}
library(oneway)
?plot()
print.oneway <- function(x, ...){
if(!inherits(x, "oneway")){
stop("Must be class 'oneway")
}
cat("Summary statistics\n",
"====================\n")
print(x$summarystats, ...)
cat("\nAnova\n",
"====================\n")
print(summary.lm(x$anova))
}
library(oneway)
summary.oneway <- function(x){
if(!inherits(x, "oneway")){
stop("Must be class 'oneway")
}
anova(x$anova)
}
library(oneway)
oneway()
?oneway
